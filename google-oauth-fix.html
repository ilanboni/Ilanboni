<!DOCTYPE html>
<html>
<head>
    <title>Fix Google Calendar OAuth Configuration</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 900px; 
            margin: 30px auto; 
            padding: 20px; 
            line-height: 1.6;
        }
        .step { 
            background: #f8f9fa; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
            border-left: 4px solid #28a745;
        }
        .critical { 
            background: #fff3cd; 
            border-left-color: #ffc107;
        }
        .code { 
            background: #f1f3f4; 
            padding: 12px; 
            margin: 10px 0; 
            border-radius: 4px; 
            font-family: 'Courier New', monospace; 
            font-size: 14px;
            word-break: break-all;
            border: 1px solid #dadce0;
        }
        .button { 
            display: inline-block; 
            background: #4285f4; 
            color: white; 
            padding: 12px 24px; 
            text-decoration: none; 
            border-radius: 4px; 
            margin: 10px 5px; 
            font-weight: 500;
        }
        .success { background: #d4edda; border-left-color: #28a745; }
        h1 { color: #1a73e8; }
        h3 { color: #5f6368; margin-top: 0; }
    </style>
</head>
<body>
    <h1>üîß Risoluzione Google Calendar OAuth</h1>
    
    <div class="step critical">
        <h3>üö® Problema Identificato</h3>
        <p>Il sistema di conferma appuntamenti funziona perfettamente e crea eventi nel calendario locale, ma la sincronizzazione con Google Calendar fallisce con errore "invalid_client".</p>
        <p><strong>Causa:</strong> L'URI di redirect OAuth non √® configurato correttamente nella Google Cloud Console.</p>
    </div>

    <div class="step">
        <h3>üîß Passo 1: Configura l'URI di Redirect</h3>
        <p>Vai alla Google Cloud Console e aggiungi questo URI di redirect esatto:</p>
        <div class="code">https://client-management-system-ilanboni.replit.app/oauth/callback</div>
        
        <ol>
            <li>Vai su <a href="https://console.cloud.google.com/apis/credentials" target="_blank">Google Cloud Console - Credentials</a></li>
            <li>Trova il tuo OAuth 2.0 client ID: <code>876070482272-badt95el39sgg9om6mumtf8tcebgiard.apps.googleusercontent.com</code></li>
            <li>Clicca per modificarlo</li>
            <li>Nella sezione "Authorized redirect URIs", aggiungi l'URI sopra indicato</li>
            <li>Salva le modifiche</li>
        </ol>
    </div>

    <div class="step">
        <h3>üîÑ Passo 2: Rinnova l'Autorizzazione</h3>
        <p>Dopo aver configurato l'URI, autorizza nuovamente l'applicazione:</p>
        <a href="https://accounts.google.com/o/oauth2/v2/auth?access_type=offline&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcalendar&prompt=consent&response_type=code&client_id=876070482272-badt95el39sgg9om6mumtf8tcebgiard.apps.googleusercontent.com&redirect_uri=https%3A%2F%2Fcavourimmobiliare-ilanboni.replit.app%2Foauth%2Fcallback" class="button" target="_blank">Autorizza Google Calendar</a>
    </div>

    <div class="step success">
        <h3>‚úÖ Situazione Attuale del Sistema</h3>
        <ul>
            <li><strong>‚úÖ Conferme appuntamenti:</strong> Funzionanti al 100%</li>
            <li><strong>‚úÖ Invio WhatsApp:</strong> Operativo</li>
            <li><strong>‚úÖ Calendario locale:</strong> Eventi creati correttamente</li>
            <li><strong>‚ö†Ô∏è Sincronizzazione Google:</strong> Necessita configurazione OAuth</li>
        </ul>
    </div>

    <div class="step">
        <h3>üß™ Passo 3: Test del Sistema</h3>
        <p>Una volta completata la configurazione OAuth, testa il sistema:</p>
        <ol>
            <li>Crea una nuova conferma appuntamento</li>
            <li>Invia il messaggio WhatsApp</li>
            <li>Verifica che l'evento appaia nel tuo Google Calendar</li>
        </ol>
        <a href="/appointment-confirmations" class="button">Vai alle Conferme Appuntamenti</a>
    </div>

    <div class="step">
        <h3>üìã Informazioni Tecniche</h3>
        <p><strong>OAuth Client ID:</strong> 876070482272-badt95el39sgg9om6mumtf8tcebgiard.apps.googleusercontent.com</p>
        <p><strong>Redirect URI richiesto:</strong></p>
        <div class="code">https://client-management-system-ilanboni.replit.app/oauth/callback</div>
        <p><strong>Scopes necessari:</strong> https://www.googleapis.com/auth/calendar</p>
    </div>

    <script>
        // Auto-refresh ogni 60 secondi per verificare aggiornamenti
        setTimeout(() => {
            console.log('Verificando stato configurazione...');
            window.location.reload();
        }, 60000);
    </script>
</body>
</html>